---
title: "Royal Dutch Shell:"
subtitle: "A Macroeconomic Analysis"
author: "Shaun Harrington"
date: "4/7/2021"
output: 
  word_document:
    reference_docx: word-styles-reference-01.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#Libraries
library(tidyverse)
library(broom)
library(car)
library(scales)
library(knitr)
library(pander)
  
options(scipen = 9999)


#User-defined functions
{
  dlog <- function(x){
    diff(log(x)) %>% return()
  }
}

#Pull data
indicators <- read.csv("Data/Combined and Prepared Data.csv")

#Revenues
rev <- indicators %>% select(Year, Region, Revenue) %>% 
  group_by(Year) %>% 
  mutate(
    Percent.Annual = Revenue / sum(Revenue)
  ) %>% ungroup()

```



# Royal Dutch Shell: A Macroeconomic Analysis

#### Motivation

  Royal Dutch Shell is a international company that spans the entire globe. As such, it is subject to several macroeconomic variables throughout numerous countries. Due to COVID-19, we have seen considerable fluctuations in the macroeconomy.

[Insert discussion of change in macroeconomic indicators over past year]

  As numerous macroeconomic indicators are highly correlated with revenues, such as the price of a barrel of oil, the net financial impact is exposed to these uncontrollable variables. By understanding the impacts, measures can be taken to mitigate the impact of changes to the macroeconomy.
  
  Royal Dutch Shell (RDS) segments revenue streams by region. Those being the United States, Europe, Other Americas, and Asia/Oceania/Africa. In 2019, the distribution of revenues were: `r rev %>% filter(Year == 2019, Region == "US") %>% pull() %>% label_percent()(.)` in the US, `r rev %>% filter(Year == 2019, Region == "Europe") %>% pull() %>% label_percent()(.)` in Europe, `r rev %>% filter(Year == 2019, Region == "Americas.Other") %>% pull() %>% label_percent()(.)` in Other Americas, and `r rev %>% filter(Year == 2019, Region == "Asia.Oceania.Africa") %>% pull() %>% label_percent()(.)` in Asia/Oceania/Africa. See below for a table of revenues by region:
  
<br>

```{r Revenue Table, echo=FALSE, message=FALSE, warning=FALSE}


rev %>% 
  select(Year, Region, Revenue) %>% 
  filter(Year > 2009) %>% 
  mutate(Revenue = label_dollar()(Revenue)) %>% 
  pivot_wider(names_from = Region, values_from = Revenue) %>% 
  pander()


```
 
 <br>

#### Objectives

  This report will cover the major macroeconomic indicators and how they impact Royal Dutch Shell. An analysis of specific measures to mitigate this risk will be compared with the goal of maximizing revenues. By evaluating the sensitivity, or elasticity, of these indicators, Royal Dutch shell will be able to quantify the risks of a changing macroeconomy. Using these elasticities, a strategy to mitigate these risks will be developed.



## Literature Review

#### Determinants of price of oil and natural gas.

#### Correlation of price of oil/LNG with macroeconomic indicators.

#### Limiting exchange rate risk of international corporations.

#### Microeconomics of Fossil Fuel industry to maximize revenues.




## Method of Analysis

#### Scope 

By means of a log-log model with regional revenues as the dependent variable and macroeconomics indicators as the independent variables, the elasticities of each of these indicators can be evaluated. However, given that available revenue data only trace back to 2004, this approach is severely limited in the vigor necessary for some of the claims that must be met. As such, a laxed approach must be considered as long as the empirical results do not counter economic theory.

The evaluated elasticities enable the ability to determine which macroeconomic variables impact revenues the greatest. Knowing these sensitivies will indicate where to allocate resources to hedge this risk.

#### Log-Log model evaluation

```{r Model Evaluation, message=FALSE, warning=FALSE, include=FALSE}

regions <- unique(indicators$Region)

model.regional.list <- lapply(regions, function(r){
    indicators %>% 
      filter(
        Region == r, Year > 2002, Year < 2019,
        !is.na(Revenue), Revenue != 0
      ) %>% 
      lm(
        dlog(Revenue) ~ dlog(consumption) +
          dlog(gdp) + dlog(indust.production) + dlog(cpi) +
          diff(interest.nom) + #dlog(gas.price) + 
          dlog(oil.price) +
          diff(unemployment.rate) + dlog(exchange.rate.index)
        , data = ., na.action = na.omit
      )
  })

names(model.regional.list) <- regions

```

The following tables are the output of this model for each region. The "dlog()" encapsulating each variable is a function that returns the first difference of the natural log of the variable.
 
 
#### Asia/Oceania/Africa:

```{r Asia Model Output, echo=FALSE, message=FALSE, warning=FALSE}

model.regional.list[["Asia.Oceania.Africa"]] %>% 
  summary() %>% tidy() %>% 
  kable(
    caption = "Asia/Oceania/Africa Log-Log Model.",
    col.names = c("Predictor", "Estimate", "SE", "t-Statistic", "P-Value"),
    digits = c(0, 2, 2, 2, 2)
  )

```

<br> 

#### Europe:

```{r Europe Model Output, echo=FALSE, message=FALSE, warning=FALSE}

model.regional.list[["Europe"]] %>% 
  summary() %>% tidy() %>% 
  kable(
    caption = "Europe Log-Log Model.",
    col.names = c("Predictor", "Estimate", "SE", "t-Statistic", "P-Value"),
    digits = c(0, 2, 2, 2, 2)
  )

```

<br> 

#### United States:

```{r US Model Output, echo=FALSE, message=FALSE, warning=FALSE}

model.regional.list[["US"]] %>% 
  summary() %>% tidy() %>% 
  kable(
    caption = "US Log-Log Model.",
    col.names = c("Predictor", "Estimate", "SE", "t-Statistic", "P-Value"),
    digits = c(0, 2, 2, 2, 2)
  )

```

<br> 

#### Other Americas:

```{r Americas.Other Model Output, echo=FALSE, message=FALSE, warning=FALSE}

model.regional.list[["Europe"]] %>% 
  summary() %>% tidy() %>% 
  kable(
    caption = "Other Americas Log-Log Model.",
    col.names = c("Predictor", "Estimate", "SE", "t-Statistic", "P-Value"),
    digits = c(0, 2, 2, 2, 2)
  )

```

<br> 

#### Hedging risk of elasticities

#### Optimization

#### Economic value-added of differing operations



## Results & Discussion

#### log-log model breakdown

#### basis of theoretical model and application

#### discussion of ideal inputs

#### Diverse operations portfolio vs. allocation towards most profitable



## Conclusion

#### Summary of available options to mitigate risk

#### How to maximize revenues given current conditions

#### Discussion of variability outside of scope